<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quantify proteoform ions — quantify_ions • fragquaxi</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Quantify proteoform ions — quantify_ions" />
<meta property="og:description" content="This function quantifies proteoform ions in a mass spectrometric (MS) data
file, which comprises several mass spectra recorded at different time points
during a chromatographic run. To this end, quantify_ions() employs a
two-step integration approach: First, each of the \(i\) ions is quantified
in each of the \(n\) mass spectra by integrating intensity in the m/z
tolerance window associated with the respective ion. This step yields an
\(i \times n\) matrix of abundances (areas under the curve), with
one row per ion and one column per scan. Rows in this matrix correspond to
extracted ion currents (XICs). Second, each XIC is integrated within the
\(r\) given retention time limits. This step yields an \(i \times
r\) matrix of abundances, with one row per ion and one column per
retention time window." />
<meta property="og:image" content="/logo.svg" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="@skafdasschaf" />
<meta name="twitter:site" content="@PLUS_1622" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fragquaxi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fragquaxi.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cdl-biosimilars/fragquaxi/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quantify proteoform ions</h1>
    <small class="dont-index">Source: <a href='https://github.com/cdl-biosimilars/fragquaxi/blob/master/R/quantification.R'><code>R/quantification.R</code></a></small>
    <div class="hidden name"><code>quantify_ions.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function quantifies proteoform ions in a mass spectrometric (MS) data
file, which comprises several mass spectra recorded at different time points
during a chromatographic run. To this end, <code>quantify_ions()</code> employs a
two-step integration approach: First, each of the \(i\) ions is quantified
in each of the \(n\) mass spectra by integrating intensity in the m/z
tolerance window associated with the respective ion. This step yields an
\(i \times n\) matrix of abundances (areas under the curve), with
one row per ion and one column per scan. Rows in this matrix correspond to
extracted ion currents (XICs). Second, each XIC is integrated within the
\(r\) given retention time limits. This step yields an \(i \times
r\) matrix of abundances, with one row per ion and one column per
retention time window.</p>
    </div>

    <pre class="usage"><span class='fu'>quantify_ions</span><span class='op'>(</span>
  <span class='va'>ms_data</span>,
  <span class='va'>ions</span>,
  rt_limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>, <span class='op'>+</span><span class='cn'>Inf</span><span class='op'>)</span>,
  filter_ms1 <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ifun_spectrum <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"adaptive"</span>, <span class='st'>"trapezoidal"</span><span class='op'>)</span>,
  ifun_xic <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"trapezoidal"</span>, <span class='st'>"adaptive"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ms_data</th>
      <td><p>Mass spectrometric data stored in an <code>mzR</code> object as returned
by <code><a href='https://rdrr.io/pkg/mzR/man/openMSfile.html'>mzR::openMSfile()</a></code>.</p></td>
    </tr>
    <tr>
      <th>ions</th>
      <td><p>A data frame specifying ions (see details).</p></td>
    </tr>
    <tr>
      <th>rt_limits</th>
      <td><p>A specification of retention time limits (see details).</p></td>
    </tr>
    <tr>
      <th>filter_ms1</th>
      <td><p>If true, only scans from MS level 1 are integrated.</p></td>
    </tr>
    <tr>
      <th>ifun_spectrum</th>
      <td><p>Integration method for spectra (see details).</p></td>
    </tr>
    <tr>
      <th>ifun_xic</th>
      <td><p>Integration method for XICs (see details).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code>quaxi</code> with seven elements:</p><dl>
<dt><code>ms_file</code></dt><dd><p>Path of the MS data file.</p></dd>
<dt><code>ifuns</code></dt><dd><p>Character vector denoting the integration methods used for
spectra and XICs, respectively.</p></dd>
<dt><code>ions</code></dt><dd><p>Data frame passed to the argument <code>ions</code> describing \(i\)
ions, with an additional column <code>ion_id</code> prepended (this column contains a
unique identifier for each ion).</p></dd>
<dt><code>rt_limits</code></dt><dd><p>Data frame with \(r\) retention time limits (columns
<code>rt_min</code> and <code>rt_max</code>) and scan indices enclosed by these limits (columns
<code>scan_min</code> and <code>scan_max</code>).</p></dd>
<dt><code>rt</code></dt><dd><p>Numeric vector containing \(n\) retention times associated
with the \(n\) scans in the MS data file.</p></dd>
<dt><code>xics</code></dt><dd><p>An \(i \times n\) matrix containing XIC intensity
values, with one row per ion and one column per scan.</p></dd>
<dt><code>abundances</code></dt><dd><p>An \(i \times r\) matrix containing
abundances, with one row per ion and one column per retention time window.</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Ion specification</h3>


<p>Ions are provided <em>via</em> a data frame that must contain two columns <code>mz_min</code>
and <code>mz_max</code> specifying the lower and upper integration limit for each ion.
The data frame may contain additional columns, which are ignored.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Retention time limits</h3>


<p><code>rt_limits</code> accepts one of the following:</p><ul>
<li><p>a numeric vector with two elements specifying a single retention time
window</p></li>
<li><p>a data frame with two colums <code>rt_min</code> and <code>rt_max</code> (other columns are
ignored) specifying one retention time window per row</p></li>
<li><p>a data type that can be converted to a data frame, such as a named list</p></li>
</ul>

<p>The values <code>-Inf</code> and <code>+Inf</code> are replaced by the minimum and maximum
retention time, respectively.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Integration methods</h3>


<p>The integration method may be selected separately for the spectrum
integration step (by <code>ifun_spectrum</code>) and the XIC integration step (by
<code>ifun_xic</code>).</p><dl>
<dt><code>"adaptive"</code></dt><dd><p>Default method for spectrum integration (step 1).
Adaptive quadrature via <code><a href='https://rdrr.io/r/stats/approxfun.html'>approxfun()</a></code> and <code><a href='https://rdrr.io/r/stats/integrate.html'>stats::integrate()</a></code>. This method
is faster, but may yield wrong results if the integrand is zero over nearly
all its range (which typically occurs if XICs are integrated over the whole
chromatogram).</p></dd>
<dt><code>"trapezoidal"</code></dt><dd><p>Default method for XIC integration (step 2).
Trapezoidal integration, i.e., the exact area under the polygonal chain
formed by (mz or retention time, intensity) tuples. This method is slower,
but always gives correct results for XIC integration.</p></dd>

</dl>



    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>ms_data</span> <span class='op'>&lt;-</span> <span class='fu'>mzR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mzR/man/openMSfile.html'>openMSfile</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"mzml"</span>, <span class='st'>"mab1.mzML"</span>, package <span class='op'>=</span> <span class='st'>"fragquaxi"</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='va'>proteins</span> <span class='op'>&lt;-</span> <span class='fu'><a href='define_proteins.html'>define_proteins</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>, <span class='st'>"mab_sequence.fasta"</span>, package <span class='op'>=</span> <span class='st'>"fragquaxi"</span><span class='op'>)</span>,
  .disulfides <span class='op'>=</span> <span class='fl'>16</span>
<span class='op'>)</span>

<span class='va'>modcoms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='define_ptm_compositions.html'>define_ptm_compositions</a></span><span class='op'>(</span><span class='va'>sample_modcoms</span><span class='op'>)</span>

<span class='va'>pfm_ions</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='assemble_proteoforms.html'>assemble_proteoforms</a></span><span class='op'>(</span><span class='va'>proteins</span>, <span class='va'>modcoms</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='ionize.html'>ionize</a></span><span class='op'>(</span><span class='fl'>36L</span><span class='op'>:</span><span class='fl'>40L</span><span class='op'>)</span>

<span class='co'># no rentention time limits: use all spectra</span>
<span class='fu'>quantify_ions</span><span class='op'>(</span><span class='va'>ms_data</span>, <span class='va'>pfm_ions</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'><span style='color: #00BBBB;'>ℹ</span> Abundances of <span style='color: #0000BB;'>30</span> ions quantified in <span style='color: #0000BB;'>352</span> mass spectra using <span style='color: #0000BB;'>1</span> retention time window.</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>── <span style='font-weight: bold;'>Parameters</span> ──</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>MS data file:</span>
#&gt; <span class='message'><span style='color: #0000BB;'>/tmp/RtmpMZpe4N/temp_libpath126f21a1228f4/fragquaxi/extdata/mzml/mab1.mzML</span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>Ions:</span></div><div class='output co'>#&gt; <span class='message'><span style='color: #949494;'># A tibble: 30 x 9</span></span>
#&gt; <span class='message'>  ion_id protein_name modcom_name formula                         mass     z</span>
#&gt; <span class='message'>  <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>         <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;mol&gt;</span>                          <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span></span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>1</span> id_1              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    36</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>2</span> id_2              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    37</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>3</span> id_3              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    38</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>4</span> id_4              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    39</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>5</span> id_5              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    40</span>
#&gt; <span class='message'><span style='color: #949494;'># … with 25 more rows, and 3 more variables: mz &lt;dbl&gt;, mz_min &lt;dbl&gt;,</span></span>
#&gt; <span class='message'><span style='color: #949494;'>#   mz_max &lt;dbl&gt;</span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>Retention time limits:</span></div><div class='output co'>#&gt; <span class='message'><span style='color: #949494;'># A tibble: 1 x 3</span></span>
#&gt; <span class='message'>  rt_min rt_max scans      </span>
#&gt; <span class='message'>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;list&gt;</span>     </span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>1</span>   2.58   900. <span style='color: #949494;'>&lt;int [352]&gt;</span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>── <span style='font-weight: bold;'>Results</span> ──</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'><span style='color: #949494;'># A tibble: 1 x 32</span></span>
#&gt; <span class='message'>  rt_min rt_max    id_1    id_2   id_3   id_4   id_5   id_6   id_7   id_8   id_9</span>
#&gt; <span class='message'>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span></span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>1</span>   2.58   900. <span style='text-decoration: underline;'>362</span>597. <span style='text-decoration: underline;'>194</span>880. 1.81<span style='color: #949494;'>e</span>5 1.26<span style='color: #949494;'>e</span>5 1.16<span style='color: #949494;'>e</span>5 7.62<span style='color: #949494;'>e</span>6 6.27<span style='color: #949494;'>e</span>6 4.47<span style='color: #949494;'>e</span>6 2.83<span style='color: #949494;'>e</span>6</span>
#&gt; <span class='message'><span style='color: #949494;'># … with 21 more variables: id_10 &lt;dbl&gt;, id_11 &lt;dbl&gt;, id_12 &lt;dbl&gt;, id_13 &lt;dbl&gt;,</span></span>
#&gt; <span class='message'><span style='color: #949494;'>#   id_14 &lt;dbl&gt;, …</span></span></div><div class='input'>
<span class='co'># define a single retention time window</span>
<span class='fu'>quantify_ions</span><span class='op'>(</span><span class='va'>ms_data</span>, <span class='va'>pfm_ions</span>, rt_limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>240</span>, <span class='fl'>330</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'><span style='color: #00BBBB;'>ℹ</span> Abundances of <span style='color: #0000BB;'>30</span> ions quantified in <span style='color: #0000BB;'>352</span> mass spectra using <span style='color: #0000BB;'>1</span> retention time window.</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>── <span style='font-weight: bold;'>Parameters</span> ──</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>MS data file:</span>
#&gt; <span class='message'><span style='color: #0000BB;'>/tmp/RtmpMZpe4N/temp_libpath126f21a1228f4/fragquaxi/extdata/mzml/mab1.mzML</span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>Ions:</span></div><div class='output co'>#&gt; <span class='message'><span style='color: #949494;'># A tibble: 30 x 9</span></span>
#&gt; <span class='message'>  ion_id protein_name modcom_name formula                         mass     z</span>
#&gt; <span class='message'>  <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>         <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;mol&gt;</span>                          <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span></span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>1</span> id_1              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    36</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>2</span> id_2              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    37</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>3</span> id_3              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    38</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>4</span> id_4              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    39</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>5</span> id_5              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    40</span>
#&gt; <span class='message'><span style='color: #949494;'># … with 25 more rows, and 3 more variables: mz &lt;dbl&gt;, mz_min &lt;dbl&gt;,</span></span>
#&gt; <span class='message'><span style='color: #949494;'>#   mz_max &lt;dbl&gt;</span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>Retention time limits:</span></div><div class='output co'>#&gt; <span class='message'><span style='color: #949494;'># A tibble: 1 x 3</span></span>
#&gt; <span class='message'>  rt_min rt_max scans     </span>
#&gt; <span class='message'>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;list&gt;</span>    </span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>1</span>    240    330 <span style='color: #949494;'>&lt;int [39]&gt;</span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>── <span style='font-weight: bold;'>Results</span> ──</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'><span style='color: #949494;'># A tibble: 1 x 32</span></span>
#&gt; <span class='message'>  rt_min rt_max    id_1    id_2   id_3   id_4   id_5   id_6   id_7   id_8   id_9</span>
#&gt; <span class='message'>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span></span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>1</span>    240    330 <span style='text-decoration: underline;'>251</span>662. <span style='text-decoration: underline;'>154</span>038. 1.49<span style='color: #949494;'>e</span>5 1.10<span style='color: #949494;'>e</span>5 1.01<span style='color: #949494;'>e</span>5 5.45<span style='color: #949494;'>e</span>6 4.60<span style='color: #949494;'>e</span>6 3.31<span style='color: #949494;'>e</span>6 2.17<span style='color: #949494;'>e</span>6</span>
#&gt; <span class='message'><span style='color: #949494;'># … with 21 more variables: id_10 &lt;dbl&gt;, id_11 &lt;dbl&gt;, id_12 &lt;dbl&gt;, id_13 &lt;dbl&gt;,</span></span>
#&gt; <span class='message'><span style='color: #949494;'>#   id_14 &lt;dbl&gt;, …</span></span></div><div class='input'>
<span class='co'># define several retention time windows;</span>
<span class='co'># instead of a list, you may also pass a data frame to rt_limits</span>
<span class='fu'>quantify_ions</span><span class='op'>(</span><span class='va'>ms_data</span>, <span class='va'>pfm_ions</span>,
              rt_limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>rt_min <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>240</span><span class='op'>)</span>, rt_max <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>60</span>, <span class='fl'>330</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'><span style='color: #00BBBB;'>ℹ</span> Abundances of <span style='color: #0000BB;'>30</span> ions quantified in <span style='color: #0000BB;'>352</span> mass spectra using <span style='color: #0000BB;'>2</span> retention time windows.</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>── <span style='font-weight: bold;'>Parameters</span> ──</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>MS data file:</span>
#&gt; <span class='message'><span style='color: #0000BB;'>/tmp/RtmpMZpe4N/temp_libpath126f21a1228f4/fragquaxi/extdata/mzml/mab1.mzML</span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>Ions:</span></div><div class='output co'>#&gt; <span class='message'><span style='color: #949494;'># A tibble: 30 x 9</span></span>
#&gt; <span class='message'>  ion_id protein_name modcom_name formula                         mass     z</span>
#&gt; <span class='message'>  <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>         <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>       <span style='color: #949494; font-style: italic;'>&lt;mol&gt;</span>                          <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span></span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>1</span> id_1              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    36</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>2</span> id_2              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    37</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>3</span> id_3              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    38</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>4</span> id_4              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    39</span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>5</span> id_5              1 G0F/G0      C<span style='color: #0000BB;'>6570</span> H<span style='color: #0000BB;'>10124</span> N<span style='color: #0000BB;'>1714</span> O<span style='color: #0000BB;'>2088</span> S<span style='color: #0000BB;'>44</span> <span style='text-decoration: underline;'>147</span>942.    40</span>
#&gt; <span class='message'><span style='color: #949494;'># … with 25 more rows, and 3 more variables: mz &lt;dbl&gt;, mz_min &lt;dbl&gt;,</span></span>
#&gt; <span class='message'><span style='color: #949494;'>#   mz_max &lt;dbl&gt;</span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>Retention time limits:</span></div><div class='output co'>#&gt; <span class='message'><span style='color: #949494;'># A tibble: 2 x 3</span></span>
#&gt; <span class='message'>  rt_min rt_max scans     </span>
#&gt; <span class='message'>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;list&gt;</span>    </span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>1</span>      0     60 <span style='color: #949494;'>&lt;int [24]&gt;</span></span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>2</span>    240    330 <span style='color: #949494;'>&lt;int [39]&gt;</span></span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'>── <span style='font-weight: bold;'>Results</span> ──</span></div><div class='output co'>#&gt; </div><div class='output co'>#&gt; <span class='message'><span style='color: #949494;'># A tibble: 2 x 32</span></span>
#&gt; <span class='message'>  rt_min rt_max    id_1    id_2   id_3   id_4   id_5   id_6   id_7   id_8   id_9</span>
#&gt; <span class='message'>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span></span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>1</span>      0     60      0       0  0   <span style='color: #949494;'> </span>  0   <span style='color: #949494;'> </span>  0   <span style='color: #949494;'> </span>  0   <span style='color: #949494;'> </span>  0   <span style='color: #949494;'> </span>  0   <span style='color: #949494;'> </span>  0   <span style='color: #949494;'> </span> </span>
#&gt; <span class='message'><span style='color: #BCBCBC;'>2</span>    240    330 <span style='text-decoration: underline;'>251</span>662. <span style='text-decoration: underline;'>154</span>038. 1.49<span style='color: #949494;'>e</span>5 1.10<span style='color: #949494;'>e</span>5 1.01<span style='color: #949494;'>e</span>5 5.45<span style='color: #949494;'>e</span>6 4.60<span style='color: #949494;'>e</span>6 3.31<span style='color: #949494;'>e</span>6 2.17<span style='color: #949494;'>e</span>6</span>
#&gt; <span class='message'><span style='color: #949494;'># … with 21 more variables: id_10 &lt;dbl&gt;, id_11 &lt;dbl&gt;, id_12 &lt;dbl&gt;, id_13 &lt;dbl&gt;,</span></span>
#&gt; <span class='message'><span style='color: #949494;'>#   id_14 &lt;dbl&gt;, …</span></span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://wolfgang.esser-skala.at'>Wolfgang Esser-Skala</a>, <a href='https://www.plus.ac.at/'>University of Salzburg</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


